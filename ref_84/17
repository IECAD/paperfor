# 논문 #17: *Improved Kalman Filtering Algorithm Based on Levenberg–Marquardt Algorithm in UWB Indoor Positioning* (Sensors, 2024)

## 1) 기본 정보
- **핵심 주제:** UWB **ADS-TWR**로 얻은 거리로 **LSM(최소자승)** 초기 좌표를 만들고, **Levenberg–Marquardt(L-M)** 로 **KF 공분산(P)** 를 보정하는 **LMKF**를 제안  
- **환경/셋업:** 2D 실내, 4 앵커(직사형 배치), 정적·NLOS 실험 및 MATLAB 시뮬레이션

**3줄 요약**
1) **LSM → KF** 표준 파이프라인에 **L-M 보정**을 넣어 관측 반복 시 **공분산 과소추정**으로 인한 불안정/느린 수렴을 완화.  
2) 시뮬레이션·실험에서 **TA/LSM/KF/UKF** 대비 **초기 수렴**과 **RMSE**가 개선.  
3) 실험 결과: **LOS**에서 **RMSE ≈ 10.8 mm**, **NLOS**에서 **RMSE ≈ 28.9 mm**(평균 X/Y 20.8/18.0 mm).

**핵심 기여**
- [x] **KF 관측 단계 직전 P 보정**: L-M(댐핑 μ)으로 \(P_k^-\)를 안정화 → 관측 업데이트 시 잔차 감소를 보장  
- [x] **값비싼 학습/라벨 없이** 범용적으로 적용 가능한 경량 개선책  
- [x] **LOS/NLOS/잡음 레벨 변화**에서 일관된 성능 이득

---

## 2) 입력·전처리·매핑
- **입력:** ADS-TWR 기반 **거리 \(d_i\)**  
- **초기화:** 4앵커로 **LSM** → 초기 \((x,y)\)  
- **상태/관측:** 상태 \([x,y,\dot x,\dot y,\ddot x,\ddot y]\), 관측 \(z=[x,y]\)  
- **KF 잡음:** \(Q\) (가속도 항 포함), \(R=\text{diag}(\sigma_x^2,\sigma_y^2)\)

**우리 20D와 매핑**

| 우리 20D 특징 | 본 논문 입력/처리 | 적용 아이디어 |
|---|---|---|
| DIST(ToF) | ADS-TWR 거리 | 동일 사용 |
| CIR/SNR/품질 | 직접 미사용 | **R 가중에 품질 반영**(동적 \(R_t\)) |
| IMU/지도 | 미사용 | IMU→상태모델 보강, 지도→게이팅 |

- **호환성:** ✅ 높음 — 기존 EKF/UKF/FG 앞단에 **LSM+LMKF 보정 모듈**로 삽입 가능

---

## 3) 모델 아키텍처
- **파이프라인:** **[ADS-TWR] → [LSM 초기 좌표] → [KF 예측] → [L-M로 \(P_k^-\) 보정] → [KF 갱신] → 위치**
- **핵심 보정(개념):**  
  \[
  P_k^- \leftarrow \Big[I - P_k^-\,(P_k^- + \tfrac{1}{\mu}I)^{-1}\Big]\,P_k^- 
  \]
  → 공분산 과소추정/발산 방지, 초기 구간 수렴 가속

**우리 모델과 비교**

| 구성 요소 | 본 논문 | 우리(20D) | 차이 |
|---|---|---|---|
| 초기해 | LSM | 다양한 초기화(가중 LSM 등) | 대체/병행 가능 |
| 안정화 | L-M로 P 보정 | 동적 R/Q, 게이팅 | 상호보완 |
| 백엔드 | KF | EKF/UKF/FG/PF | 그대로 호환

---

## 4) 학습/설정
- **비학습형**: L-M(μ), KF(Q,R), LSM  
- **상태천이행렬:** 상수가속도 모델(Δt 포함)  
- **파라미터 팁:** 초기 μ는 크게→수렴하며 감소, Q는 주행성에 맞춰 튜닝

---

## 5) 실험·결과(대표)
- **시뮬레이션(정적, 잡음 0.01):**  
  - TA/LSM/KF/UKF/LMKF 비교에서 **LMKF AVE(X/Y) ≈ 3.08/3.01 mm, RMSE ≈ 5.5 mm**  
  - 잡음 분산 0.1~1.0 증가에도 LMKF가 **최소 RMSE** 유지(잡음 0.75에서 타 방법 대비 RMSE 10–60%↓)
- **실험(실내 6.0×5.4 m; 4앵커):**  
  - **LOS:** 평균 X/Y **6.9/5.4 mm**, **RMSE 10.8 mm**  
  - **NLOS(장애물 1개):** 평균 X/Y **20.8/18.0 mm**, **RMSE 28.9 mm**  
  - UKF 대비 **초기 수렴 빠름**, 전체 RMSE **~30%↓**

---

## 6) 우리 연구와의 관계
- **즉시 적용 포인트**
  - [x] **LMKF 보정 스텝**을 현행 EKF/UKF 앞단에 삽입(코드 영향 최소)  
  - [x] **품질지표(CIR/SNR/NLOS score)** → **동적 \(R_t\)** 와 **μ 스케줄**에 연동  
  - [x] **지도/가시성 게이트**와 병용해 NLOS 시 발산 억제
- **예상 효과:** 초기/전이 구간 수렴 가속, 고잡음·약NLOS에서 RMSE 하락

**벤치마킹 가치**  
- Related Work: ⭐⭐⭐  
- Baseline(필터 안정화 라인): ⭐⭐⭐⭐⭐  
- 구현 참고(간결·경량): ⭐⭐⭐⭐⭐

---

## 7) 논문 작성 활용 메모
- **Related Work 문장 초안**  
  > “LSM 초기해 후 **L-M 보정 KF(LMKF)** 를 적용해 관측 반복의 공분산 과소추정을 완화, **LOS 10 mm대 / NLOS 30 mm대 RMSE**로 TA/LSM/KF/UKF 대비 초기 수렴과 정확도를 동시에 개선했다.”
- **Methodology 차용**  
  1) **L-M 보정**을 우리 EKF/UKF/FG 공통 모듈로 일반화  
  2) **품질·지도 연동형 μ 스케줄**(NLOS 의심↑ → μ↑)

---

## 8) 재현 팁
- LSM 초기화 실패 대비 **가중 LSM/근사 GN** 백업  
- μ는 로그 스케줄(크게 시작→잔차 안정 시 감소)  
- NLOS 의심 시 **게이팅 후** LMKF 적용(잔차 폭주 방지)

---

## 9) 구현 체크리스트
- [x] **LMKF 모듈**(P 보정 함수, μ 스케줄러)  
- [x] **동적 R_t**(CIR/SNR/NLOS score 반영)  
- [x] **초기화 파이프라인**(LSM→LMKF)  
- [ ] **Ablation**: L-M on/off, μ 스케줄, R_t 고정/동적, NLOS 유/무  
- **우선순위:** 🟢 (낮은 구현비용 대비 즉각적 개선 기대)
