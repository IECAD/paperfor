# 논문 #13: *An Integration of Deep Neural Network-Based Extended Kalman Filter (DNN-EKF) Method in UWB Localization for Distance Loss Optimization* (Sensors, 2024)

## 1) 기본 정보
- **핵심 주제:** UWB 실내 위치추정에서 **DNN + EKF**를 결합한 **DNN-EKF**로 궤적 오차(“distance loss”)를 최소화
- **환경/셋업:** Pozyx UWB, ROS(TurtleBot3), LiDAR 초기자세 정렬(orientation), 비전 트래킹으로 GT 구축

**3줄 요약**
1) DNN이 학습한 위치/오차 패턴을 EKF 갱신에 통합한 **DNN-EKF** 파이프라인 제안.  
2) 비교대상(**NN-EKF**, **LPF-EKF**, 원시 UWB 등) 대비 **평균 distance loss 최소**.  
3) **학습률(lr)** 탐색 결과 **lr=0.1에서 최저 68.06 mm**를 기록(다른 lr도 69 mm대).

**핵심 기여(Contribution)**
- [x] **학습형 DNN**과 **확장 칼만필터(EKF)**의 밀결합 구조 정식화  
- [x] **학습률 스윕**과 기존 필터/NN 결합법 대비 **정량 비교**  
- [x] 로봇 실제 주행(ROS) 궤적에서 **distance loss 지표**로 효과 검증

---

## 2) 입력 데이터 (Input)
- **UWB 범위(거리) 시퀀스** + 로봇 주행 데이터(odometry 등)  
- **GT 구성:** 상부 카메라 기반 비전 트래킹(투시변환, 512×512 → 4 m×4 m 맵 스케일링), LiDAR scan-matching으로 초기 자세 정합

**우리 20D 입력과의 매핑**

| 우리 20D 특징 | 논문 입력/처리 | 변환/활용 아이디어 |
|---|---|---|
| DIST(ToF) | UWB 범위 | 동일 사용(단위/좌표계 정합) |
| CIR/SNR/품질 | 명시적 사용 적음 | **DNN 입력에 품질채널 추가**(동적 R 또는 잔차 가중) |
| IMU/주행 | EKF 동역학에 반영 | 우리 IMU 채널을 **예측모델 강화**에 활용 |

- **호환성 평가:** ✅ 높음 — 프런트엔드(UWB/DNN) → 백엔드(EKF) 구조라 바로 삽입 가능

---

## 3) 모델 아키텍처 (Architecture)
- **파이프라인:** **[UWB/주행] → DNN(위치/오차 보정 추정) → EKF(예측·갱신) → 최종 위치**  
- **역할 분담:** DNN이 **비선형 오차 패턴**을 학습해 추정치를 제공/보정하고, EKF가 **동역학 일관성**과 **잡음 공분산 반영**으로 시공간 스무딩

**우리 모델과 비교**

| 구성 요소 | 논문(DNN-EKF) | 우리 모델 | 차이 |
|---|---|---|---|
| UWB 전처리 | 단순 필터+학습 | 품질/맵/분류기 사용 | 우리는 **CIR/SNR/NLOS** 정보를 추가 투입 가능 |
| 결합 방식 | DNN 출력 ↔ EKF 결합 | 가중 EKF/UKF/FG | 우리 쪽은 **동적 R/Q 추정**로 확장 유리 |
| 지표 | distance loss(mm) 중심 | MAE/RMSE 등 병행 | 지표 확장·통합 필요 |

---

## 4) 학습 방법 (Training)
- **DNN:** MLP 회귀(세부 레이어 표기는 간략), **학습률(lr)** 0.001/0.01/0.1 비교  
- **정규화/전처리:** Min-Max 스케일링 등(개념적으로 기술)  
- **EKF:** 표준 예측/갱신(관측은 UWB 거리/혹은 DNN 보정치)

---

## 5) 실험 및 결과 (Experiments)
- **평가 지표:** **Distance loss (mm)** — 예측 궤적 vs 실제 궤적의 평균 이격  
- **비교군:** **LPF-EKF**, **NN-EKF**, **원시 UWB** 등

**핵심 수치(평균 distance loss)**

| 방법 | 평균 distance loss |
|---|---:|
| **DNN-EKF (lr=0.1)** | **68.06 mm** |
| DNN-EKF (lr=0.01) | 69.02 mm |
| DNN-EKF (lr=0.001) | 69.08 mm |
| NN-EKF | 73.35 mm |
| LPF-EKF | 75.30 mm |
| 원시 UWB | 76.73 mm |

또한 (lr=0.01 설정에서) 원시 UWB 기준의 **MSE(x)=64.56, MSE(y)=60.13**을 보고.  
 [oai_citation:0‡13. An Integration of Deep Neural Network-Based Extended Kalman Filter (DNN-EKF) Method in Ultra-Wideband (UWB) Localization for Distance Loss Optimization.pdf](sediment://file_00000000a22061fb8a6591a55b696541)  [oai_citation:1‡13. An Integration of Deep Neural Network-Based Extended Kalman Filter (DNN-EKF) Method in Ultra-Wideband (UWB) Localization for Distance Loss Optimization.pdf](sediment://file_00000000a22061fb8a6591a55b696541)  [oai_citation:2‡13. An Integration of Deep Neural Network-Based Extended Kalman Filter (DNN-EKF) Method in Ultra-Wideband (UWB) Localization for Distance Loss Optimization.pdf](sediment://file_00000000a22061fb8a6591a55b696541)

---

## 6) 우리 연구와의 관계
- **유사점:** UWB 기반 관측 + 필터 기반 추정의 2-스테이지 구조  
- **차이점:** 논문은 **distance loss 최적화**에 초점, 품질채널(CIR/SNR)·맵가중·NLOS 클래식 분리 사용은 제한적  
- **즉시 적용 포인트**
  - [x] **DNN-EKF 블록**을 프런트엔드 보정 모듈로 삽입(후단 EKF/UKF/FG 그대로)  
  - [x] **CIR/SNR/NLOS score**를 DNN 입력에 추가 → **동적 측정공분산 Rₜ** 산출(또는 잔차 보정)  
  - [x] **지표 통합:** distance loss ↔ RMSE/MAE/CDF를 **동시에 리포팅**하도록 실험 템플릿 정비

**벤치마킹 가치**  
- Related Work: ⭐⭐⭐⭐  
- Baseline(학습+필터 결합선): ⭐⭐⭐⭐⭐  
- 구현 참고(ROS/Pozyx 세팅): ⭐⭐⭐⭐

---

## 7) 논문 작성 활용 메모
- **Related Work 한 줄**  
  > “UWB 로봇 위치추정에서 **DNN-EKF** 결합으로 기존 **NN-EKF/LPF-EKF** 대비 **distance loss ~68 mm**까지 낮추는 실험적 이점을 보였다.”
- **Methodology 차용 포인트**  
  1) **DNN 출력 → EKF 관측모델/공분산 동적화** 두 루트 비교  
  2) **학습률/입력채널 스윕 표준화**(lr, CIR/SNR 유무, NLOS 비율 등)  
- **Figure/Table 아이디어**  
  - (Fig) **DNN-EKF 파이프라인**(입력채널, EKF 결합 위치)  
  - (Tbl) **Distance loss & RMSE/MAE**: 원시 UWB vs LPF-EKF vs NN-EKF vs **DNN-EKF(lr별)**

---

## 8) 참고 포인트(구현/재현)
- Pozyx UWB, ROS(TurtleBot3), 비전 트래킹/투시변환, LiDAR 초기자세 정렬 절차  
- Distance loss 계산 방식, **lr=0.1 최적** 관찰, 비교군 구성

---

## 9) 구현 체크리스트
- [x] **DNN-EKF 모듈** (입력: 거리 + 품질채널 옵션 / 출력: 보정치 또는 동적 Rₜ)  
- [x] **학습 스크립트**(lr 스윕, k-fold, 조기종료)  
- [x] **EKF 인터페이스**(DNN 출력 연결, 동적 R/Q 주입 옵션)  
- [x] **리포팅 자동화**(distance loss, RMSE/MAE, CDF, 학습곡선)  
- [ ] **CIR/SNR/NLOS 피처 엔지니어링**(ablation)  
- **우선순위:** 🟢
