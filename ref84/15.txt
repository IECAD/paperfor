# 논문 #15: *A Non-Line-of-Sight Mitigation Method for Indoor UWB Localization With Multiple Walls* (IEEE TII, 2023)

## 1) 기본 정보
- **주제:** 여러 **벽 두께·유전율이 서로 다른 다중 벽** 환경에서 UWB **관통(through-wall) NLOS** 오차를 **수치적 모델링 + 에러맵 + GWO 최적화**로 보정
- **키워드:** Snell 법칙, **Levenberg–Marquardt(비선형 방정식 해)**, **Error Map(오프라인 계산)**, **Grey Wolf Optimizer(GWO)**

**3줄 요약**
1) **공간 기하 평형식**(입사각/굴절각/경로분해)으로 **단일·평행·수직 다중 벽**의 **TOA 거리 편향**을 **수치적으로 계산**.  
2) 벽 **두께(w)**는 도면/현장 측정, **상대 유전율(εr)**은 **간단한 교정식**으로 추정 후, **격자(예: 10×10cm)**에 대해 **앵커별 오차맵**을 **현장 측정 없이** 산출.  
3) **오차맵으로 보정된 거리**를 사용해 **GWO**로 위치를 추정—정적 RMSE **≈17 cm**, 원시 대비 **~60%** 감소; **연속 주행**에서도 80% 크로스트랙 **<25 cm** 수준.

**핵심 기여**
- [x] **다중 벽·비수직 입사**까지 다루는 **일반화된 through-wall 오차 모델**  
- [x] **현장 핑거프린트 없이** 오차맵을 **수치 계산**하는 절차 제시  
- [x] **GWO 기반** 위치추정으로 기존 맵 기반 보정부호(단순 모델) 대비 **RMSE 대폭 개선**

---

## 2) 입력·전처리·매핑
- **입력:** 앵커–태그 **TOA 거리**, **실내 도면 기반 벽 파라미터**(두께 w, εr), **앵커 좌표**  
- **전처리:** 벽별 **εr 교정(간단한 2-TWR 측정)** → **수치해(Levenberg–Marquardt)**로 격자별 **관통오차** 계산 → **앵커별 오차맵** 저장

**우리 20D와의 매핑**

| 우리 20D 특징 | 논문 처리 | 활용 포인트 |
|---|---|---|
| 거리(d) | 오차맵으로 보정 | 프런트엔드 보정 블록으로 즉시 삽입 |
| CIR/SNR 품질 | 직접 미사용 | **오차맵±품질가중** 하이브리드 가능 |
| 맵/레이캐스팅 | 필수(벽) | 기존 맵 가시성 모듈과 결합 용이 |

- **호환성:** ✅ 높음 — “거리 보정 → 기하/필터” 2-스테이지 구조 그대로 적용 가능

---

## 3) 모델 아키텍처
**[도면(w, εr) + 앵커/태그 좌표] → (기하 평형식·Snell) → 수치해(L-M) → 격자별 에러맵(Ei) →**
**측정 d̂ 보정( d̃ = d̂ − e ) → GWO로 (x,y) 최적화 추정**

- **단일/평행/수직 다중 벽**을 각각의 연립식으로 모델링  
- **GWO**: 상위 3개 해(α, β, γ늑대) 유도→개체 갱신→최솟값 해 선택

---

## 4) 학습(Training)
- **딥러닝 없음**. 수치 최적화(L-M) + 메타휴리스틱(GWO) 조합  
- 하이퍼파라미터: **격자 크기(권장 10×10 cm)**, **GWO 개체수 K≈15, 반복 T≈30**

---

## 5) 실험·결과(요약)
- **환경:** 공장형 실내(14×20 m), **3 앵커(DW1000)**, **3개 내벽**(w=13/13/20 cm), 정적 29포인트·연속 주행 시나리오  
- **거리 보정 효과:** 평균 **원시 43.16 cm → 보정 15.53 cm**  
- **정적 위치 성능:** **RMSE ≈ 16.99 cm**, 비교 모델(단순 맵 기반 보정들) **28–34 cm** 수준 → **우위**  
- **CDF(정적):** 80% 오차 **< 30 cm** (타 방법 50–70 cm)  
- **연속 주행:** 평균 **크로스트랙 ≈ 13.3 cm**, 80% **< 25 cm**  
- **민감도/견고성:** εr **±30% 오차**에도 성능 저하 **작음**; **격자 10 cm**에서 **성능–계산량 균형** 양호; **문/창**은 보정 시 **오차 <~6 cm**로 간주 가능

---

## 6) 우리 연구와의 관계
- **보완성:** 학습형 **NLOS 분류/품질가중**과 **맵 기반 물리 보정(본 논문)**을 **동시에** 쓰면 강건성↑  
- **즉시 적용 포인트**
  - [x] **오차맵 보정 블록**을 프런트엔드에 추가(맵·벽 파라미터 입력)  
  - [x] **CIR/SNR 가중**을 곱한 **하이브리드 보정**(맵 보정의 잔차를 품질로 재가중)  
  - [x] 백엔드는 **EKF/UKF/FG/PF** 그대로—현재 파이프라인에 **d → d̃**만 교체

**벤치마킹 가치**  
- Related Work: ⭐⭐⭐⭐  
- Baseline(맵 기반 NLOS 완화): ⭐⭐⭐⭐⭐  
- 구현 참고(에러맵·수치해·GWO): ⭐⭐⭐⭐⭐

---

## 7) 논문 작성 활용 메모
- **Related Work 한 줄**  
  > “다중 벽에서 **Snell+수치해**로 **through-wall 오차맵**을 계산하고 **GWO**로 위치를 추정, 정적 **≈17 cm RMSE**와 80% **<30 cm**를 달성.”  
- **Methodology 차용**  
  1) **격자 오차맵 + 품질가중** 하이브리드 프런트엔드  
  2) **격자 크기 스윕(1–100 cm)**로 **성능–계산량** 곡선 보고  
- **Figure/Table 아이디어**: (Fig) **벽·광선 분할→서브에어리어→오차맵** / (Tbl) **원시 vs 보정 vs 기존맵기반** RMSE·CDF

---

## 8) 참고 포인트(재현 체크)
- εr **현장 간이 교정식**, **다중 벽(평행/수직) 연립식**과 **L-M 초기값**, **GWO 파라미터**, **정적/연속 평가 프로토콜** 전반

---

## 9) 구현 체크리스트
- [x] **도면 파서**(벽 두께·선분 추출) & **εr 교정 스크립트**  
- [x] **오차맵 생성기**(L-M 수치해, 격자 크기 옵션)  
- [x] **보정 거리 API**(d̂→d̃) + **GWO/EKF/UKF 인터페이스**  
- [ ] **CIR/SNR 결합 실험**(하이브리드 보정 Ablation)  
- **우선순위:** 🟢 (맵 가용 환경에서 즉시 성능↑ 기대)